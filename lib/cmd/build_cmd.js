/**
 * This module is based on webpack. It provides development and deploy features.
 */const{doCmd,rm}=require("../util/utils"),print=require("../util/print"),_=require("lodash"),{generateWebpackConfig}=require("../webpack/config"),{loadHoneyConfig}=require("../util/config"),webpack=require("webpack");async function buildCmd(){try{await doCmd("npm i --save core-js@3"),await doCmd("npm i")}catch(a){print.error(a)}const a=loadHoneyConfig();try{await rm(a.dist);//build
const b=generateWebpackConfig(a);webpack(b,(a,b)=>{if(a)throw a;process.stdout.write(b.toString({colors:!0,modules:!1,children:!1,// If you are using ts-loader, setting this to true will make TypeScript errors show up during build.
chunks:!1,chunkModules:!1})+"\n\n"),b.hasErrors()&&(print.error("  Build failed with errors.\n"),process.exit(1)),print.info("  Build complete.\n")})}catch(a){print.error(a)}}module.exports={buildCmd};