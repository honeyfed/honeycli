/**
 * This module is based on webpack. It provides development and deploy features.
 */const{doCmd,rm,writeFile}=require("../util/utils"),print=require("../util/print"),{getEslintrc}=require("../lint/lint"),{getPrettierrc}=require("../format/rc"),path=require("path"),{generateWebpackConfig}=require("../webpack/config"),{loadHoneyConfig}=require("../util/config"),webpack=require("webpack"),webpackDevServer=require("webpack-dev-server");async function devCmd(){try{await doCmd("npm i --save core-js@3"),await doCmd("npm i --save-dev --force eslint eslint-plugin-vue eslint-config-tencent"),await doCmd("npm i"),rm(path.resolve(process.cwd(),".eslintrc.js")),rm(path.resolve(process.cwd(),".eslintrc.json")),rm(path.resolve(process.cwd(),".eslintrc")),rm(path.resolve(process.cwd(),".prettierrc")),writeFile(path.resolve(process.cwd(),".eslintrc.js"),getEslintrc()),writeFile(path.resolve(process.cwd(),".prettierrc"),JSON.stringify(getPrettierrc()))}catch(a){print.error(a)}const a=loadHoneyConfig();try{//build
const b=generateWebpackConfig(a,"development"),c=new webpackDevServer(webpack(b),b.devServer);c.listen(a.dev.port,"0.0.0.0",()=>{print.info(`Starting server on http://localhost:${a.dev.port}`)})}catch(a){print.error(a)}}module.exports={devCmd};