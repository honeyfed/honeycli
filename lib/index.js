module.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=18)}([function(e,t,n){const r=n(21);e.exports={info:function(e){console.log(r.green(e))},error:function(e){"object"==typeof e&&(e=JSON.stringify(e)),console.log(r.red(e))}}},function(e,t){e.exports=require("path")},function(e,t,n){const r=n(5),o=n(0),i=n(9),s=n(22),a=n(23),c=n(24);const l=a.promisify(s);e.exports={makeGithubUrlForTbTemplate:function(e){return`https://github.com/honeyfed/template-${e}.git`},loadJson:function(e){const t=r.readFileSync(e,"utf-8");try{return JSON.parse(t)}catch(e){o.error(e)}return null},isValidName:function(e){return/^[a-zA-Z0-9-_]+$/.test(e)},isValidLibName:function(e){return/^[a-z0-9-]+$/.test(e)},doCmd:function(e,t,n={stdio:"inherit"}){return new Promise((r,o)=>{"win32"===process.platform&&0===e.indexOf("npm")&&(e="npm.cmd");const s=i(e,t,n);n.stdio?s.on("close",e=>{r({code:e})}):(s.stdout.on("data",e=>{r({data:e})}),s.stdout.on("close",e=>{r({data:e})}))})},rm:l,readFile:function(e){return r.readFileSync(e,"utf8")},writeFile:function(e,t){r.writeFileSync(e,t,"utf8")},getFiles:function(e){return new Promise(t=>{c(e,(e,n)=>{e?(o.error(e&&e.message),t([])):t(n)})})}}},function(e,t,n){const r=n(25),{loadJson:o}=n(2),i=n(1),s=n(6),a=n(0);const c={src:"./src",dist:"./dist",entry:"index.js",template:"index.html",static:"",isLib:!1,dev:{port:8080,proxy:[],mock:""}};e.exports={loadTemplates:async function(){try{const e=await r.get("https://raw.githubusercontent.com/honeyfed/config/master/templates.json");return JSON.parse(e)}catch(e){console.error(e)}return null},loadHoneyConfig:function(){const e=o("./package.json"),t={};return s.merge(t,c),e&&e.honeyConfig?s.merge(t,e.honeyConfig):a.info("no config found"),t.src=i.resolve(process.cwd(),t.src),t.dist=i.resolve(process.cwd(),t.dist),t.static&&(t.static=i.resolve(process.cwd(),t.static)),e.name&&(t.packageName=e.name),t}}},function(e,t,n){const r=n(1);e.exports={getPathInLib:function(e){return r.resolve(__dirname,"../",e)}}},function(e,t){e.exports=require("fs")},function(e,t){e.exports=require("lodash")},function(e,t){e.exports=require("webpack")},function(e,t,n){n(1);const{getPathInLib:r}=n(4);e.exports={getEslintrc:function(){return'\n  module.exports = {\n    env: {\n      browser: true,\n    },\n    parserOptions: {\n      parser: "babel-eslint",\n      ecmaVersion: 2017,\n      sourceType: "module",\n    },\n    extends: ["plugin:vue/essential","plugin:react/recommended","eslint-config-tencent"],\n    plugins: ["vue","react"],\n  };\n  '},getEsLintOptions:function(){return{fix:!0,extensions:[".js",".jsx",".vue"],useEslintrc:!1,errorOnUnmatchedPattern:!1,overrideConfigFile:r("./config/eslintrc.js")}}}},function(e,t){e.exports=require("cross-spawn")},function(e,t,n){n(9);const{GitError:r}=n(11),{doCmd:o}=n(2),i=n(0),s=process.cwd(),a="win32"===process.platform;e.exports={gitClone:async function(e,t=""){const n=await o("git",["clone",e,t,"--depth",1],{stdio:"inherit"});if(0===n.code)return n.code;new r("git clone failed")},isGitRepo:async function(e){try{return 0===(await o("git",["rev-parse","--git-dir"],{cwd:e,stdio:"inherit"})).code}catch(e){return!1}},getStatus:async function(e){const t=await o("git",["status","--short",e||"."],{cwd:s});if(!t||!t.data)return i.info("当前没有需要提交的记录"),"";let n=Buffer.from(t.data);return n=n.toString(),n.trim()?(n=n.split("\n").filter(e=>e.trim()),a&&(n=n.map(e=>e.slice(3))),await async function(e){await o("git",["status","--short",e||"."],{cwd:s,stdio:"inherit"})}(),n):void 0},gitPush:async function(e){return await o("git",["push",e||""],{cwd:s,stdio:"inherit"})},getUnpushedCommits:async function(){const e=await o("git",["cherry","-v"],{cwd:s});if(e.data){return Buffer.from(e.data).toString()}return e.data},gitAdd:async function(e){return await o("git",["add",e],{cwd:s,stdio:"inherit"})}}},function(e,t){class n extends Error{constructor(e){super(e)}}e.exports={GitError:n}},function(e,t){e.exports=require("inquirer")},function(e,t,n){const{loadHoneyConfig:r}=n(3),{getFiles:o,readFile:i,writeFile:s}=n(2),a=n(0),{getPrettierrc:c}=n(14),l=n(32),u=n(1);e.exports={formatCmd:async function(){const e=r();let t=await o(e.src+"/**/*.js");const n=await o(e.src+"/**/*.vue");t=[...t,...n];const d=c();t.forEach(async e=>{a.info(`格式化 ${e}...`);const t=i(e),n=u.extname(e);d.parser=".vue"===n?"vue":"babel";try{const n=l.format(t,d);s(e,(n||"").replaceAll("\r\n","\n"))}catch(e){a.error(e&&e.message)}})}}},function(e,t){e.exports={getPrettierrc:function(){return{arrowParens:"always",bracketSpacing:!0,endOfLine:"lf",htmlWhitespaceSensitivity:"css",insertPragma:!1,jsxBracketSameLine:!1,jsxSingleQuote:!0,printWidth:80,proseWrap:"preserve",quoteProps:"as-needed",requirePragma:!1,semi:!0,singleQuote:!0,tabWidth:2,trailingComma:"es5",useTabs:!1,vueIndentScriptAndStyle:!1,parser:"babel"}}}},function(e,t,n){const r=n(1),o=n(7),i=n(34),s=n(35),a=n(36),{generateBasicWebpackConfig:c}=n(16),l=n(0);function u(e){const t=e.dev.proxy,n={};return Array.isArray(t)&&t.length&&t.forEach(t=>{if(t.from&&t.to&&(n[t.from]={target:t.to,changeOrigin:!0,cookieDomainRewrite:"localhost"},e.dev.mock)){const o=r.resolve(process.cwd(),e.dev.mock);delete require.cache[require.resolve(o)];try{const e=require(o);n[t.from].bypass=e}catch(e){l.error(e&&e.message),l.error("mock文件加载错误")}}}),n}e.exports={generateWebpackConfig:function(e,t="production"){const n=c(e,t);return n.output={path:e.appPath?r.resolve(e.dist,a.urlToRelatedDir(e.appPath)):e.dist,filename:"production"===t?"js/[name].[hash:6].js":"js/[name].js",publicPath:e.appPath?a.fixUrlSuffix(e.appPath):"/"},n.optimization={splitChunks:{chunks:"all"}},n.devServer={port:e.port,hot:!0,publicPath:e.appPath?a.fixUrlSuffix(e.appPath):"/",historyApiFallback:{rewrites:[{from:/.*/,to:a.fixUrlSuffix(e.appPath||"/")+"index.html"}]},proxy:u(e)},n.plugins.push(new i({template:r.resolve(e.src,e.template)})),e.static&&n.plugins.push(new s({patterns:[{from:e.static,to:e.dist}]})),e.appPath&&n.plugins.push(new o.DefinePlugin({APPPATH:JSON.stringify(e.appPath)})),n}}},function(e,t,n){const r=n(1),{VueLoaderPlugin:o}=n(37),i=n(38),s=n(39),{getEsLintOptions:a}=n(8),{getPathInLib:c}=n(4),{browserslistrc:l}=n(40);e.exports={generateBasicWebpackConfig:function(e,t="production"){const n={loader:"postcss-loader",options:{postcssOptions:{plugins:[require("postcss-preset-env")({browsers:l})]}}};return e.rem&&n.options.postcssOptions.plugins.push(require("postcss-pxtorem")({rootValue:100,unitPrecision:8,propList:["*"]})),{mode:t,entry:r.resolve(e.src,e.entry),resolve:{extensions:[".js",".jsx",".vue",".json"],alias:{"@":e.src}},resolveLoader:{modules:[c("./node_modules")]},module:{rules:[{test:/\.jsx?$/,loader:"babel-loader",options:{cwd:c("./"),presets:[["@babel/preset-env",{useBuiltIns:"usage",corejs:3,targets:l}],"@babel/preset-react"]},exclude:/node_modules/},{test:/\.vue$/,loader:"vue-loader"},{test:/\.css$/,use:["style-loader","css-loader",n]},{test:/\.less$/,use:["style-loader","css-loader",n,"less-loader"]},{test:/\.(ttf|woff)$/,use:[{loader:"url-loader",options:{name:"production"===t?"fonts/[name]-[hash:6].[ext]":"fonts/[name].[ext]",limit:8092,esModule:!1}}]},{test:/\.(gif|png|jpg|jpeg|svg)$/,use:[{loader:"url-loader",options:{name:"production"===t?"imgs/[name]-[hash:6].[ext]":"imgs/[name].[ext]",limit:8092,esModule:!1}}]}]},devtool:"production"===t?"none":"eval-source-map",plugins:[new o,new i,new s(a())]}}}},function(e,t,n){const{CdnUploader:r}=n(42),{loadHoneyConfig:o}=n(3),{getFiles:i}=n(2),s=n(0),a=n(1);function c(e,t,n){return a.join(e,a.relative(t,n)).replaceAll("\\","/")}e.exports={cdnCmd:async function(){const e=new r;if(!e.init())return void s.error("cos初始化失败");const t=o(),n=t.dist;let a=await i(n+"/js/**/*.js"),l=await i(n+"/style/**/*.css"),u=await i(n+"/imgs/**/*"),d=await i(n+"/fonts/**/*");a=a.map(e=>({cdnPath:c(t.packageName,t.dist,e),filePath:e})),l=l.map(e=>({cdnPath:c(t.packageName,t.dist,e),filePath:e})),u=u.map(e=>({cdnPath:c(t.packageName,t.dist,e),filePath:e})),d=d.map(e=>({cdnPath:c(t.packageName,t.dist,e),filePath:e})),a.forEach(async t=>{try{await e.uploadFile(t.cdnPath,t.filePath),s.info("已上传"+t.filePath)}catch(e){s.error(e),s.error(t.filePath+"上传失败")}}),l.forEach(async t=>{try{await e.uploadFile(t.cdnPath,t.filePath),s.info("已上传"+t.filePath)}catch(e){s.error(e),s.error(t.filePath+"上传失败")}}),u.forEach(async t=>{try{await e.uploadFile(t.cdnPath,t.filePath),s.info("已上传"+t.filePath)}catch(e){s.error(e),s.error(t.filePath+"上传失败")}}),d.forEach(async t=>{try{await e.uploadFile(t.cdnPath,t.filePath),s.info("已上传"+t.filePath)}catch(e){s.error(e),s.error(t.filePath+"上传失败")}})}}},function(e,t,n){const r=n(19),{newCmd:o}=n(20),{serve:i}=n(28),{gitCommit:s,gitPushCmd:a,generateChangeLog:c}=n(29),{buildCmd:l}=n(33),{devCmd:u}=n(44),{formatCmd:d}=n(13),{lintCmd:p}=n(47),{cdnCmd:f}=n(17),{upgradeCmd:m}=n(49),g=n(0),{loadJson:h}=n(2),{getPathInLib:w}=(n(1),n(4));e.exports={main:function(){const e=h(w("./package.json"));g.info("honey cli v"+e.version),r.version(e.version).command("new").alias("n").description("创建新的项目").action(o),r.command("commit").alias("c").description("提交代码").action(e=>{s()}),r.command("push").alias("p").description("推送代码").action(e=>{a()}),r.command("changelog").alias("log").description("生成changelog").action(e=>{c()}),r.command("build").alias("b").description("构建代码").action(e=>{l()}),r.command("cdn").description("资源上传cdn").action(e=>{f()}),r.command("dev").alias("d").description("启动本地开发").action(e=>{u()}),r.command("lint").alias("l").description("代码检查").action(e=>{p()}),r.command("format").alias("fmt").description("代码格式化").action(e=>{d()}),r.command("extend <command>").alias("e").description("run an extend command").action(e=>{g.info(e)}),r.command("upgrade").alias("u").description("检查最新版本honey-cli").action(e=>{m()}),r.parse(process.argv)}}},function(e,t){e.exports=require("commander")},function(e,t,n){const{makeGithubUrlForTbTemplate:r,isValidName:o,rm:i,getFiles:s}=n(2),{gitClone:a}=n(10),{GitError:c}=n(11),l=n(12),{loadTemplates:u}=n(3),d=n(0),p=n(5),f=n(1),{renderInPlaceSync:m}=n(27);e.exports={newCmd:async function(e){try{const e=await u();if(!e)throw new Error("未找到模板");const t=await l.prompt([{type:"input",name:"projectName",message:"project name",validate:e=>e?!!o(e)||"invalid project name(only alphabet number _ - were allowed)":"project name should not be empty"},{type:"list",name:"template",message:"choose template",choices:()=>e.map(e=>({name:`${e.name} (${e.description}) - ${e.valid?"valid":"invalid"}`,value:e}))}]);if(!t.template.valid)throw new Error("invalid template: "+t.template.name);{const e=r(t.template.name);await a(e,t.projectName),await i(t.projectName+"/.git");(await s(t.projectName+"/**/*")).forEach(e=>{if(p.lstatSync(e).isFile()){d.info("正在写入"+e);const n=f.extname(e);/\.(txt|markdown|md|js|jsx|vue|html|json|less|css|scss|styl)$/i.test(n)&&m(e,{name:t.projectName})}})}}catch(e){e instanceof c?d.error(e.message):d.error(e)}}}},function(e,t){e.exports=require("chalk")},function(e,t){e.exports=require("rimraf")},function(e,t){e.exports=require("util")},function(e,t){e.exports=require("glob")},function(e,t,n){const r=n(26);e.exports={get:async function(e){const t=await r.get(e);return t&&200===t.status?t.text:""}}},function(e,t){e.exports=require("superagent")},function(e,t,n){const{readFile:r,writeFile:o}=n(2);e.exports={renderInPlaceSync:function(e,t){let n=r(e);Object.keys(t).forEach(e=>{n=n.replaceAll(new RegExp(`{{{${e}}}}`,"gi"),t[e])}),o(e,n)}}},function(e,t,n){const r=n(5),o=n(1),{doCmd:i}=n(2);e.exports={serve:async function(){const e=o.resolve("./"),t=r.readdirSync(e);if(t.length<=0)return void console.error("当前文件夹为空");if(!t.filter(e=>e.indexOf("package.json")>-1))return void console.error("当前文件夹不存在package.json文件，请添加");if(0!==await i("npm",["install"]))return void console.error("install error");let n=r.readFileSync(e+"/package.json");JSON.parse(n).scripts.dev?await i("npm",["run","dev"]):console.error("当前package.json文件中不存在dev命令")}}},function(e,t,n){const r=n(12),{getStatus:o,gitPush:i,getUnpushedCommits:s,gitAdd:a}=n(10),c=(n(1),n(30)),l=n(31).bootstrap,u=n(0),{formatCmd:d}=n(13),{getPathInLib:p}=n(4);e.exports={gitCommit:async function(){await d();const e=await o(),t=await s();if(t&&console.log(` (${t.split("\n").filter(e=>e).length} commits unpushed)`),Array.isArray(e)){const t=await r.prompt({type:"checkbox",name:"files",message:"请选择要提交的文件:",choices:e.map(e=>({name:e})),pageSize:20});if(t&&t.files&&t.files.length>0){const n=t.files.length===e.length?".":t.files.join(" ");return 0===(await a(n)).code&&await l({cliPath:p("./node_modules/commitizen"),config:{path:p("./3rd/cz-conventional-changelog")}},""),!0}}},gitPushCmd:async function(){if(await s()){(await r.prompt({type:"confirm",name:"pushCommits",message:"Do you want to push now?",default:!1})).pushCommits&&await i("-u")}},generateChangeLog:async function(){c({noVerify:!0,infile:"docs/CHANGELOG.md",silent:!0}).then(()=>{u.info("changelog 生成成功，位于docs/CHANGELOG.md文件中")}).catch(e=>{u.error("standard-version failed with message: "+e.message)})}}},function(e,t){e.exports=require("standard-version")},function(e,t){e.exports=require("commitizen/dist/cli/git-cz")},function(e,t){e.exports=require("prettier")},function(e,t,n){const{doCmd:r,rm:o,isValidLibName:i}=n(2),s=n(0),a=n(6),{generateWebpackConfig:c}=n(15),{generateWebpackLibConfig:l}=n(41),{loadHoneyConfig:u}=n(3),d=n(7),{cdnCmd:p}=n(17);e.exports={buildCmd:async function(){try{await r("npm",["i","--save","core-js@3"]),await r("npm",["i","--save","regenerator-runtime"]),await r("npm",["i"])}catch(e){s.error(e)}const e=u();try{await o(e.dist);let t=null;if(e.isLib){if(!e.libName)return void s.error("请在package.json的honeyConfig里配置libName");if(!i(e.libName))return void s.error("libName必须遵循蛇形命名");e.umdName||(e.umdName=a.camelCase(e.libName)),t=l(e)}else t=c(e);await function(e){return new Promise((t,n)=>{d(e,(e,r)=>{e?n(e):(process.stdout.write(r.toString({colors:!0,modules:!1,children:!1,chunks:!1,chunkModules:!1})+"\n\n"),r.hasErrors()&&(s.error("  Build failed with errors.\n"),process.exit(1)),s.info("  Build complete.\n"),t())})})}(t),e.cdn&&await p()}catch(e){s.error(e)}}}},function(e,t){e.exports=require("html-webpack-plugin")},function(e,t){e.exports=require("copy-webpack-plugin")},function(e,t){e.exports={urlToRelatedDir:function(e){return"/"!==e.slice(-1)&&(e+="/"),"/"===e[0]&&(e=e.slice(1)),"./"+e},fixUrlSuffix:function(e){let t=e;return"/"!==t.slice(-1)&&(t+="/"),t}}},function(e,t){e.exports=require("vue-loader")},function(e,t){e.exports=require("progress-bar-webpack-plugin")},function(e,t){e.exports=require("eslint-webpack-plugin")},function(e,t,n){"use strict";n.r(t),n.d(t,"browserslistrc",(function(){return r}));const r="> 0.25%, not dead"},function(e,t,n){const{generateBasicWebpackConfig:r}=n(16);e.exports={generateWebpackLibConfig:function(e){const t=r(e,"production");return t.output={path:e.dist,filename:e.libName+".min.js",library:e.umdName,libraryTarget:"umd"},t}}},function(e,t,n){const r=n(43),o=n(0),i=n(5);e.exports={CdnUploader:class{constructor(){}init(){return process.env.cdnId&&process.env.cdnKey?(this.cos=new r({SecretId:process.env.cdnId,SecretKey:process.env.cdnKey}),!0):(o.error("请在环境变量中设置cdnId及cdnKey"),this.cos=null,!1)}uploadFile(e,t){return new Promise((n,r)=>{this.cos.putObject({Bucket:"static-1258919571",Region:"ap-guangzhou",Key:"honeyfed/"+e,Body:i.readFileSync(t)},(function(e,t){e?(o.error(e),r(e)):n(t)}))})}}}},function(e,t){e.exports=require("cos-nodejs-sdk-v5")},function(e,t,n){const{doCmd:r,rm:o,writeFile:i}=n(2),s=n(0),{getEslintrc:a}=n(8),{getPrettierrc:c}=n(14),l=n(1),{generateWebpackConfig:u}=n(15),{loadHoneyConfig:d}=n(3),p=n(7),f=n(45),m=n(46),g=n(6);function h(e){return new Promise(t=>{try{const n=u(e,"development"),r=new f(p(n),n.devServer);r.listen(e.dev.port,"0.0.0.0",()=>{s.info("Starting server on http://localhost:"+e.dev.port),t(r)})}catch(e){s.error(e),t(null)}})}e.exports={devCmd:async function(){try{await r("npm",["i","--save","core-js@3"]),await r("npm",["i","--save","regenerator-runtime"]),await r("npm",["i","--save-dev","--force","eslint","eslint-plugin-vue","eslint-plugin-react","eslint-config-tencent"]),await r("npm",["i"]),await o(l.resolve(process.cwd(),".eslintrc.js")),await o(l.resolve(process.cwd(),".eslintrc.json")),await o(l.resolve(process.cwd(),".eslintrc")),await o(l.resolve(process.cwd(),".prettierrc")),i(l.resolve(process.cwd(),".eslintrc.js"),a()),i(l.resolve(process.cwd(),".prettierrc"),JSON.stringify(c()))}catch(e){s.error(e)}const e=d();let t=await h(e);if(e.dev&&e.dev.mock){const n=l.resolve(process.cwd(),e.dev.mock);m.watch(n).on("change",g.throttle(()=>{const n=t;t=null,n&&n.close(async()=>{t=await h(e)})},2e3,{leading:!0,trailing:!1}))}}}},function(e,t){e.exports=require("webpack-dev-server")},function(e,t){e.exports=require("chokidar")},function(e,t,n){const{ESLint:r}=n(48),{getEsLintOptions:o}=n(8),{loadHoneyConfig:i}=n(3);e.exports={lintCmd:async function(){const e=i(),t=new r(o()),n=await t.lintFiles([e.src+"/**/*.vue",e.src+"/**/*.js",e.src+"/**/*.jsx"]);await r.outputFixes(n);const s=(await t.loadFormatter("stylish")).format(n);console.log(s)}}},function(e,t){e.exports=require("eslint")},function(e,t,n){const r=n(0),{doCmd:o,loadJson:i}=n(2),{getPathInLib:s}=n(4),a=n(50);e.exports={upgradeCmd:async function(){r.info("正在检查更新...");const e=i(s("./package.json")),t=await o("npm",["view",e.name,"version"],{}),n=Buffer.from(t.data).toString().trim(),c=e.version,l=a(n,c);if(0===l)r.info("当前是最新版本哦，亲~");else if(1===l){r.info("发现新版本: "+n),r.info("尝试升级中...");0===(await o("npm",["i","-g",e.name])).code?r.info("安装成功"):(r.error("安装失败"),r.info("请用管理员权限尝试该命令: npm install --global "+e.name))}else r.info("年轻人不讲武德哦~")}}},function(e,t){e.exports=require("compare-versions")}]);